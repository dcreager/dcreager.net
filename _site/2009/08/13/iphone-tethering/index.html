<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>iPhone tethering</title>
    <meta name="author" content="Douglas Creager" />

    

    <link rel="alternate" type="application/atom+xml"
          title="dcreager.net" href="/atom.xml"/>
 
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css" type="text/css" />

    <!-- main CSS -->
    <link rel="stylesheet" href="/css/main.css" type="text/css" />
  </head>

  <body>

    <div class="site">
      <div class="site_content">
        <div class="left">
          <div class="leftnav">
            <p><a href="/">Home</a></p>
<p><a href="/archive/">Archive</a></p>
<p><a href="/publications/">Publications</a></p>

          </div>
        </div>

        <div class="site_header">
          <p class="title">dcreager.net</p>
          <p class="subtitle">A BLOG ABOUT HUGE DATA, CODING, AND MISCELLANEA</p>
        </div>

        <div class="body">
          
<h1>iPhone tethering</h1>

<div class="postdate">
  Thursday, August 13, 2009
</div>

<div class="post">
  <p>While attending the <a href='http://mil-oss.org/'>Mil-OSS conference</a> this week, I had the opportunity to use one of the coolest features of my new iPhone 3GS — Bluetooth Internet tethering. Assuming that your mobile carrier allows the feature on their network, it provides a very easy way to have a persistent Internet connection, for those situations where a free Ethernet drop or WiFi access point aren&#8217;t readily available.</p>

<p>I happened to have my Dell Mini 9 (running Ubuntu Jaunty) with me for the conference, rather than my MacBook, so I thought that it might be difficult to get the Bluetooth connection working between the phone and laptop. This <a href='http://xn--9bi.net/2009/06/17/tethering-iphone-3-0-to-ubuntu-9-04/'>blog posting</a>, however, provided exactly what I needed.</p>

<p>Following this process, the connection worked without a hitch. One caveat is that I didn&#8217;t need to explicitly pair my phone with my laptop; the first time I ran the <code>pand --connect</code> command, my phone prompted me with the pairing confirmation dialog. Later connections didn&#8217;t require re-pairing.</p>

<p>As for bandwidth, the connection was perfectly reasonable for email and basic Web surfing as long as I had decent 3G coverage — 3 of 5 bars or higher and I was good to go. I also did an <code>apt-get</code> package update as a “beefier” test; I was usually seeing around 20-30 Kb/sec of download speed, which would be fine for small daily updates, but would probably be unworkable for something large like a GNOME, texlive, or GHC update. All in all, not bad for some surreptitious email checking during the talks.</p>

<h2 id='commandline_scripts'>Command-line scripts</h2>

<p>One thing that can be cumbersome about the instructions on the blog post is that you have to run the <code>pand</code> and <code>ifup</code>/<code>ifdown</code> commands separately each time you want to start or stop the Bluetooth connection. Not a huge waste of effort, to be sure, but we can do better. So I wrote a quick little Bash script that will start and stop the connection with a single command. You can find the script in <a href='http://github.com/dcreager/home/commit/f5c0db363049f7433494924c63d4a2a19e325b6c'>this commit</a> on my Github page.</p>

<p>The script is fairly straightforward; you start your Bluetooth tether by running</p>

<pre><code>tether up</code></pre>

<p>and you stop it by running</p>

<pre><code>tether down</code></pre>

<p>Instead of hard-coding your phone&#8217;s Bluetooth MAC address into the script itself, you place it into the <em>$HOME/etc/bluetooth.conf</em> file. This file isn&#8217;t checked into Git, so that I&#8217;m not putting my personal MAC addresses into the public repository. Instead, the commit contains a <em>$HOME/etc/bluetooth.conf.sample</em> file, which you copy over to <em>bluetooth.conf</em>, and then edit appropriately.</p>

<h2 id='issues'>Issues</h2>

<p>While this script worked great for during the conference, there are two main issues with it as it stands.</p>

<ul>
<li>
<p><strong>dbus integration</strong> — Many applications now listen to the system&#8217;s dbus message bus to determine different facts about the current state of the system, including whether there&#8217;s an active Internet connection. The NetworkManager application knows to publish the correct dbus messages when it starts and stops a network connection. The <code>tether</code> script does not. This means that each time I open up Firefox after turning on the tether, I have to manually uncheck the <em>File › Work Offline</em> menu option to be able to access any web pages.</p>

<p>Fixing this issue should only require finding the appropriate dbus messages to send, and adding them to the <code>up</code> and <code>down</code> cases in the script.</p>
</li>

<li>
<p><strong>GUI access</strong> — While I don&#8217;t mind running a simple command to activate and deactivate the network connection, I realize that a GUI control within the NetworkManager applet would be more ideal. (This would also eliminate the first issue, since NetworkManager would then send the appropriate dbus messages when the connection is started or stopped.) Luckily, Dan Williams has recently <a href='http://blogs.gnome.org/dcbw/2009/07/10/unwire-with-networkmanager/'>added Bluetooth PAN support</a> to <code>nm-applet</code>. The new code is in the bleeding edge tree, so hopefully it will make it into a release in time to be picked up for October&#8217;s Karmic release.</p>
</li>
</ul>
</div>

        </div>

        

        <div class="body_separator"></div>

        <div class="body">
          <div id="disqus_thread"></div>

          <script type="text/javascript">
            var disqus_title = "iPhone tethering";
            var disqus_url = "http://dcreager.net/2009/08/13/iphone-tethering/";
          </script>

          <script
             type="text/javascript"
             src="http://disqus.com/forums/dcreager/embed.js">
          </script>
          <noscript>
            <a href="http://dcreager.disqus.com/?url=ref">View the discussion thread.</a>
          </noscript>

          <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>

        

      </div>
    </div>

    <div class="footer">
      <div class="copyright">
        Copyright © 2009, Douglas Creager.  All rights reserved.
      </div>
    </div>

  </body>
</html>

